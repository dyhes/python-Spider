共同工作

整体目标：

  我们希望通过爬虫代码在bilibili上全方位地爬取一位虚拟主播“嘉然今天吃什么”的二次创作视频及其相关信息，主要包括二创每日增长数量，每月二创数量，每个视频的播放量，每个相关up主的二创数量等等。

在我们看来，光是爬取到这些信息本身是没有意义的，所以在确定选题时，我们就着重考虑爬取到的内容是否能创造价值。对以上爬取到的各类数据进行一些简单基础的可视化和综合分析，借此来判断嘉然在一段时间内的热度和流量变化，判断不同二创的受欢迎程度。

除此之外，我们还想编写一个网页作为二创播放器，链接到bilibili对应的二创视频，在我们的页面就可以随机播放所爬取的所有视频。

总体框架：

  python代码分为cralwing.py,processing.py,recrawling.py三个文件，第一个用于进行数据采集及储存，第二个用于进行数据处理并进行可视化，第三个用于为播放器爬取二创视频BV号。

  在crawling文件中包含main(),getHTMLText(),getInfo(),dataStorage()四个函数，后三个分别负责页面抓取，数据采集并预处理以及存储

在processing.py中有七个函数dataread(),mysort(),myPlot(),upVisualize()

viewVisualize(),timeVisualize(),zoneVisualize()前三者分别进行数据读取，数据排序，数据可视化，后四个函数分别用于对从文件中的原始数据进行特殊化处理

html代码分为jiaran.html和main.js，分别进行网页框架构建与随机二创功能实现

第三方库：

Requests:

  Requests是用python语言基于urllib编写的，采用的是Apache2 Licensed开源协议的HTTP库。

bs4:

  Beautiful Soup提供一些简单的、python式的函数用来处理导航、搜索、修改分析树等功能。

matplotlib:

  matplotlib是基于numpy的一套Python工具包。这个包提供了丰富的数据绘图工具,主要用于绘制一些统计图形。

第三方库均从anoconda（下载地址https://www.anaconda.com）引入

软件运行环境：

python运行环境采取pycharm中使用anaconda部署python环境的方式

**个人工作**

关键代码说明：

  经观察发现搜索页的url参数page表示页数，最多访问五十页，order表示排序方式，总共有综合排序（totalrank），最多点击（click），最新发布（pubdate），最多弹幕（dm），最多收藏(stow)五种，为了获取尽可能多的二创视频，采取在main()函数中以二重循环遍历250个网页，每爬取得一个网页利用time.sleep()函数休眠2s以防止被封锁ip，并爬取每个网页中20个视频的具体信息，并排除重复视频，最终爬得3121个二创视频

之后利用beautifulsoup对获取的页面进行处理，经过预先的页面审查发现在页面html代码中每个视频均作为一个class为‘video-item’的li被封装于 class为‘video-list’的ol中，而所需爬取的视频信息均放于li下class为‘’Info’的div，其中分区信息，视频标题，视频链接均位于class为"headline "的div块中，其中分区信息位于class为type的span中，标题和链接位于class为title的a的title,href属性中，播放量，上传日期，up主昵称均位于class为“tags”的div块的子元素span中，titile分别为 观看，上传时间，up主，于是利用find_all()函数获取20个视频的相对应信息组成的列表，并通过标题来判断是否为已经爬取过的视频

将未重复的视频信息储存相对应的字典中，并在爬取结束后将字典的键值分别储存在csv文件的两个行中，等待后续取用并数据处理

之后在数据处理的过程中以直方图形式画出播放量的区间分布，以折线图形式画出二创数随时间的变化曲线，以饼状图的形式画出嘉然二创视频的分区分布比例，以条形图的形式画出创作二创数大于20个的up主排名

  在后续制作播放器过程中注意到仅需爬取每个视频的bv号并通过url拼接便可在iframe中播放视频，为避免繁琐的读取文件过程，并为了保证随机出的二创视频质量，对综合排序前1000的二创视频BV号进行了重新爬取并通过split函数取出视频BV号放入列表中，最后统一打印并复制到main.js文件中供后续随机二创播放器使用

效果和结论

通过嘉然二创分布图可得嘉然的二创视频大部分分布于综合区，占比高达40.45%,其次为搞笑区和日常区，同时又涉及广泛，包含了许许多多其他分区

由up主随创作数排名可知创作二创数量最多的为贾布加布，其次为嘉然官方账号中运营代发的直播切片

由播放区间分布可得嘉然的二创视频大致服从钟形曲线，播放量大多集中于50万-400万的区间，然而400万以上的仍有为数不少的二创视频，说明嘉然二创中存在大量高质量视频

​     由展现二创数随时间变化趋势的两张图中可以看出，即使受限于b站的搜索机制无法爬取得所有的二创视频，我们依然可以看出嘉然相关的二创数随月份增长不断增加并且增加速度不断攀升，这也与嘉然的粉丝数与热度自去年十二月出道以来不断增加的客观事实相吻合，相比之下9-3，9-4数据为此两日二创数的真实值，更侧面展现出如今嘉然二创圈子的蓬勃发展，欣欣向荣。